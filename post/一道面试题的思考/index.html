
<!DOCTYPE html>
<html lang="zh">
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta content="Rubyist, Python, JavaScript" name="keywords">
<meta name="description" content="renyijiu&#39;s blog!">

<meta content="一道面试题的思考 - renyijiu" property="og:title">
<title>一道面试题的思考 | renyijiu</title>
<link rel="shortcut ico" href="/favicon.ico" type="image/x-icon"/>
<link rel="stylesheet" href="/css/style.css">

<section class="section">
  <div class="container">
    <nav class="nav">
      <div class="nav-left">
        <a class="nav-item" href="https://yijiu.ren"><h1 class="title is-4">renyijiu</h1></a>
      </div>
      <div class="nav-right">
        <nav class="nav-item level is-mobile">
          
          <a class="level-item" href="https://github.com/renyijiu">
            <span class="icon">
              <i class="fa fa-github"></i>
            </span>
          </a>
          
          <a class="level-item" href="/about">
            <span class="icon">
              <i class="fa fa-user"></i>
            </span>
          </a>
          
          <a class="level-item" href="/index.xml">
            <span class="icon">
              <i class="fa fa-rss"></i>
            </span>
          </a>
          
        </nav>
      </div>
    </nav>
  </div>
</section>

<section class="section">
  <div class="container">
    <h2 class="subtitle is-6">June 1, 2017</h2>
    <h1 class="title">一道面试题的思考</h1>
    
    <div class="content">
      <p>面试时碰到的一道题目，题目的要求是：</p>

<blockquote>
<p>The definition of a Fibonacci sequence is like this:</p>

<ul>
<li><p>F(0) = 0</p></li>

<li><p>F(1) = 1</p></li>

<li><p>F(n) = F(n-1) + F(n-2)</p></li>
</ul>

<p>Now let&rsquo;s define G(n) = F(n)/F(n+1).</p>

<p>Golden ratio is the limit of G(n) when n approaches infinity.</p>

<p>With all the above information, we have a way to estimating golden ratio g:</p>

<p>Find the first n that matches |G(n+1) - G(n)| &lt; t, where t is the precision threshold, then the corresponding G(n) is considered as the estimated value of golden ratio.</p>
</blockquote>

<p>第一眼看到这题的时候，脑子里蹦出来的就是“递归”实现<a href="https://zh.wikipedia.org/zh/%E6%96%90%E6%B3%A2%E9%82%A3%E5%A5%91%E6%95%B0%E5%88%97">斐波那契数列</a>，然后去计算G(n)的值，去计算判断一下即可，所以代码如下：</p>

<pre><code class="language-ruby">def estimate_golden_ratio(t)
  return nil if t &lt;= 0

  n = 2
  while n do
    result = (cal_g(n+1) - cal_g(n)).abs

    if (result &lt; t)
        return n
    else
        n += 1
    end
  end
end

def fibonacci(n)
    return n if n &lt;= 1
    (fibonacci(n-1) + fibonacci(n-2))
end

def cal_g(n)
    return (fibonacci(n).to_f / fibonacci(n+1).to_f)
end

puts estimate_golden_ratio(1e-6)
puts estimate_golden_ratio(1e-8)
puts estimate_golden_ratio(1e-10)
puts estimate_golden_ratio(1e-15)
puts estimate_golden_ratio(1e-20)
</code></pre>

<p>然后理所当然的会有问题，递归实现的问题就是计算度高的时候会导致超时。面试官问了下有没有什么想法去优化，我的反应就是使用循环去替代递归实现，这样子可以提高计算。</p>

<p>但后面<strong>经过提醒</strong>仔细想了下，这个不是单纯的计算数列，它是需要获得一个期望的n值，不断的循环去获得所期望的值，其实呢也就是不断循环的计算F()，这里面重复的计算其实也是一个影响因素，当然修改斐波那契数列也是提高计算速度的。所以自己的想法是使用一个数组去保存计算的值，减少重复计算。</p>

<pre><code class="language-ruby">FI_ARRAY = [0, 1]

def estimate_golden_ratio(t)
  return nil if t &lt;= 0

  n = 2
  while n do
    result = (cal_g(n+1) - cal_g(n)).abs

    if (result &lt; t)
        return n
    else
        n += 1
    end
  end
end

def fibonacci(n)
    arr_length = FI_ARRAY.length

    if n &gt;= arr_length
        for i in arr_length..n
            FI_ARRAY[i] = FI_ARRAY[i-1] + FI_ARRAY[i-2]
        end
    end

    return FI_ARRAY[n]
end

def cal_g(n)
    return (fibonacci(n).to_f / fibonacci(n+1).to_f)
end

puts estimate_golden_ratio(1e-6)
puts estimate_golden_ratio(1e-8)
puts estimate_golden_ratio(1e-10)
puts estimate_golden_ratio(1e-15)
puts estimate_golden_ratio(1e-20)
</code></pre>

<p>当然这个也是有它的问题，当计算度变高时，需要保存的值增多，数组也会变大，空间消耗也会增多。后面想了下，也写了个普通的解法，当然呢这里面还是存在大量重复计算，所以计算应该还是上面那个更快。</p>

<pre><code class="language-ruby">def estimate_golden_ratio(t)
  return nil if t &lt;= 0

  n = 2
  while n do
    tmp_g, tmp_g_1 = cal_g(n)
    result = (tmp_g_1 - tmp_g).abs

    if (result &lt; t)
        return n
    else
        n += 1
    end
  end
end

def fibonacci(n)
    result_array = [0, 1]
    first, second = result_array

    for i in 2..n+1
        third = first + second
        first = second
        second = third
    end

    result_array = [first, second]
    return result_array
end

def cal_g(n)
    tmp_n, tmp_n_1 = fibonacci(n)
    tmp_n_2 = tmp_n + tmp_n_1

    tmp_g = tmp_n.to_f / tmp_n_1.to_f
    tmp_g_1 = tmp_n_1.to_f / tmp_n_2.to_f
    return [tmp_g, tmp_g_1]
end

puts estimate_golden_ratio(1e-6)
puts estimate_golden_ratio(1e-8)
puts estimate_golden_ratio(1e-10)
puts estimate_golden_ratio(1e-15)
puts estimate_golden_ratio(1e-20)
</code></pre>

<p>上面的代码是满足了题目设定的计算，但是自己考虑，当给出的t过小时，浮点数的精度损失大于了t时，这个就会产生结果上的误差，此时就需要考虑其他的方案了。</p>

<p>从此可以看出来，一道简单的题其实可以引申出来探讨的内容还是很多的，有时还是需要自己多思考，多探索，还是多努力加油吧！</p>

    </div>
  </div>
</section>


<section class="section">
  <div class="container has-text-centered">
    <P>Live For Dream, Dream For Love</P>
    <p>Hosted by <a href='https://pages.coding.me' style='font-weight: bold'>Coding Pages</a> &copy; <a href="https://yijiu.ren">renyijiu</a> 2017</p>
  </div>
</section>
<link href="//maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous" media="none" onload="if(media!='all')media='all'">

<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/styles/atom-one-light.min.css" media="none" onload="if(media!='all')media='all'">

<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/highlight.min.js" integrity="sha256-KbfTjB0WZ8vvXngdpJGY3Yp3xKk+tttbqClO11anCIU=" crossorigin="anonymous"></script>

<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/languages/go.min.js"></script>

<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/languages/javascript.min.js"></script>

<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/languages/python.min.js"></script>

<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/languages/ruby.min.js"></script>

<script>hljs.initHighlightingOnLoad();</script>


<script>
window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
ga('create', 'UA-78885477-1', 'auto');
ga('send', 'pageview');
</script>
<script async src='//www.google-analytics.com/analytics.js'></script>



